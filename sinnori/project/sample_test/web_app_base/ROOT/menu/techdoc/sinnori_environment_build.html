<pre>
<h1>신놀이 개발 환경 구축</h1>
<h2>주) 신놀이는 역동적으로 변하고 있습니다. 
이 문서는 git 를 이용한 최신 버전을 기준으로 설명하기때문에 
다운로드하여 받은 배포 버전과 차이가 있을 수 있습니다.</h2>

1. 신놀이 개발 프레임워크 시작하기
	
	1.다운로드
		신놀이를 이용하기 위해 가장 먼저 해야할 일입니다. 
		다운 로드 방법부터 설명하겠습니다.
		앞으로 모든 설명은 2가지 운영체제 우분투와 윈도7을 기준으로 설명할 것입니다.
		  

		1.공통
			먼저 다운 로드할 디렉토리를 만듭니다.
			아래는 제 컴퓨터 기준의 순차적인 절차입니다. 
			자신의 컴퓨터에 맞도록 수정하셔야 합니다.
				우분투
					터미널에서 (1) cd ~
					(2) mkdir gitsinnori
				윈도7
					명령 프롬프트(=cmd) (1) d:
					(2) mkdir gitsinnori
					  

		2.git 이용 다운로드
			git 설치후 신놀이 프레임워크를 다운 로드 받습니다.
	::우분투::
	터미널에서 (1) sudo apt-get install git
	(2) git clone https://github.com/SinnoriTeam/gitsinnori.git gitsinnori
	(3) cd gitsinnori
	(4) git checkout v1.0

	:: 윈도7::
	(1) msysgit 를 설치합니다.
	msysgit 홈피 주소는 http://code.google.com/p/msysgit/ 입니다.
	홈피 들어가셔서 다운로드후 설치를 진행하시기 바랍니다.
	git 설치시 참고한 주소 : 
http://forum.falinux.com/zbxe/index.php?document_srl=588283&mid=lecture_tip
주의점) 권장하는 데로 "advenced context menu" 를 꼭 선택해서 설치를 해 주시기 바랍니다. 
	앞으로 이 기준으로 설명할것이기때문입니다.
	(2) Windows 탐색기를 이용하여 gitsinnori 디렉토리에서 
	마우스 오른쪽 버튼을 눌러 나오는 팝업 메뉴에서
	Git Bash Here" 를 선택합니다. 
	그러면 윈도우 환경에서 우분투랑 비슷한 터미털이 뜨지요.
	그 다음은 위에 언급한 우분투 (2) 항에서 (4)항까지 동일합니다.
					  

		3.파일 링크 통한 다운로드
			다운로드 메뉴를 통해서 압축 파일을 받운 받으셔서 압축을 푼신후			
			3개 파일(.gitignore, LICENSE, README.md)과 1개 폴더(sinnori) 를
			작업할 gitsinnori 로 복사를 하시면 됩니다.		
			  

	2.ant build 환경 만들기
		신놀이 개발 프레임워크는 ant build 를 기준으로 배포를 하기때문에 
		자바와 Ant 설치되어 있어야 합니다.
		자바및 ant 설치는 언급하지 않겠습니다.
		신놀이를 다운 로드 받은 이후에는 "신놀이 Ant 환경 구축 유틸"
(우분투:SinnoriAntBuildUtil.sh, 윈도우:SinnoriAntBuildUtil.bat) 프로그램을 수행시킵니다.
		"신놀이 Ant 환경 구축 유틸" 프로그램은 지정된 설치 경로 기준으로
		프로젝트 개발과 구동에 필요한 신놀이 설정파일와 
		ant.properties 그리고 쉘의 내용중 경로 관련 된 부분을 
		자동적으로 수정시켜 주는 유틸리티 프로그램입니다.
		단, 대부분 경로 부분은 신놀이가 설치된 경로를 기준으로 자동 설정되지만,
		수동으로 경로를 지정해야 하는 경우가 있습니다.
		대표적인 예로 톰켓 설치 여부를 설치로 선택하면
		톰캣 라이브러리 경로를 선택해 주어야 톰캣과 연동이 되는 ant 환경이 구축됩니다.
		하지만 톰켓과 연동은 이곳에서는 다루지 않겠습니다.
		따라서 톰켓 설치 여부를 "미 설치" 로 선택 해주세요. 

		우분투
			터미널에서 (1) cd sinnori
			(2) ./SinnoriAntBuildUtil.sh
		윈도7
			명령 프롬프트(=cmd) (1) cd sinnori
			(2) SinnoriAntBuildUtil.bat
			  

	3.예제로 제공된 파일 송수신 서버/클라이언트 실행 하기
		신놀이 프레임워크를 이용하여 파일 송수신 서버/클라이언트를 구현한것을 
		예제로 제공하고 있습니다.
		로컬에서 도는 서버와 클라이언트로 동작하는것을 확인해 보세요. 

		1.우분투
			첫번째 터미널에서 파일 송수신 서버 실행
	(1) cd ~/gitsinnori/sinnori/project/sample_simple_ftp/server_build/
	(2) ant all
	(3) ./sinnori_server.sh
			두번째 터미널에서 파일 송수신 클라이언트 실행
	(1) cd ~/gitsinnori/sinnori/project/sample_simple_ftp/client_build/app_build/
	(2) ant all
	(3) ./sinnori_appclient.sh
		2.윈도7
			첫번째 명령 프롬프트에서 파일 송수신 서버 실행
(1) cd /D d:\gitsinnori\sinnori\project\sample_simple_ftp\server_build
	(3) ant all
	(4) sinnori_server.bat
			두번째 명령 프롬프트에서 파일 송수신 클라이언트 실행
	(1) d: 
(2) cd d:\gitsinnori\sinnori\project\sample_simple_ftp\client_build\app_build
	(3) ant all
	(4) sinnori_appclient.bat
</pre>
==============================
<h2>웹과 신놀이 서버 인터넷 통한 접근을 하기위한 작업</h2><br/>
<textarea name="content" wrap="soft" style="width:580px; height:220px;" readonly="readonly">
0. 웹과 신놀이 서버 인터넷 통한 접근을 하기위한 작업
	1. 유동 IP에 도메인 할당및 호스트 madang 추가
		HOWTO_유동IP에도메인할당.odt 문서 참고
	
		참고 : 유동 IP와 domain 을 연결시켜 주는 서비스 업체 www.codns.com 에서
		"MyDNS 설정" 메뉴 화면을 보면 "서비스 도움말" 에 호스트 추가 방법 설명이 있음.
		
	2. 공유기에서 할일
		KT 홈허브 : KT에서 제공하는 와이파이 기능 제공하는 허브.

		KT 홈허브 설정 파일 주소 : http://172.30.1.254

		장치설정 -> 트랙픽 관리 -> 포트 포워딩 설정
		
		1. 웹 : 외부에서는 www.sinnori.pe.kr 라는 도메인으로 접근
			외부포트 : 80
			내부 IP 주소 : 172.30.1.15
			내부 포트 : 80
			프로토콜 : TCP
		2. 신놀이 서버 : 외부에서는 madang.sinnori.pe.kr:9090 도메인으로 접근
			외부포트 : 9090
			내부 IP 주소 : 172.30.1.16
			내부 포트 : 9090
			프로토콜 : TCP

1. Apache 와 tomcat 설치및 환경설정	
	1. 우분투
		1. tomcat7 설치
		sudo apt-get install tomcat7
		2. 아파치 설치
		sudo apt-get install apache2
		3. 아파치와 tomcat7  연동 모듈설치
		sudo apt-get install libapache2-mod-jk
		4. tomcat7 사용자와 www-data 사용자한테 WEB 의 ROOT 파일 접근 권한 부여 ex) sudo addgroup tomcat7 <userid>; sudo addgroup www-data <userid>
		5. apache 에서 www.sinnori.pe.kr 호스트 설정파일인 vhost1.conf 작성

		madang01@madang01-TZ68K:/etc/apache2/sites-available$ cat /etc/apache2/sites-available/vhost1.conf
		<virtualhost www.sinnori.pe.kr>
			JkMount /*.jsp ajp13_worker
			JkMount /servlet/* ajp13_worker
			ServerName www.sinnori.pe.kr
			ServerAdmin k9200544@hanmail.net
			DocumentRoot /home/madang01/gitsinnori/sinnori/project/sample_test/web_app_base/ROOT
			ErrorLog /home/madang01/gitsinnori/sinnori/project/sample_test/log/apache/error.log
			CustomLog /home/madang01/gitsinnori/sinnori/project/sample_test/log/apache/access.log common
			<directory /home/madang01/gitsinnori/sinnori/project/sample_test/web_app_base/ROOT>
				Options -Indexes
			</directory>
		</virtualhost>


		6. /etc/hosts 파일에 공유기에 등록된 IP 와 도메인이름 등록. ex) "172.30.1.15 www.sinnori.pe.kr" 추가

		madang01@madang01-TZ68K:/usr/share/java$ cat /etc/hosts
		127.0.0.1	localhost
		127.0.1.1	madang01-TZ68K
		172.30.1.15 www.sinnori.pe.kr

		# The following lines are desirable for IPv6 capable hosts
		::1	 ip6-localhost ip6-loopback
		fe00::0 ip6-localnet
		ff00::0 ip6-mcastprefix
		ff02::1 ip6-allnodes
		ff02::2 ip6-allrouters


		7. tomcat 에서 host 등록
		server.xml 파일은 윈도7 기준 CATALINA_HOME\conf 에 있고 우분투는 /etc/tomcat7 디렉토리에 있다. server.xml 에 host 를 추가한다. ex) 우분투 /etc/tomcat7/server.xml 에 추가할 내용

		<Host name="www.sinnori.pe.kr" appBase="/home/madang01/gitsinnori/sinnori/project/sample_test/web_app_base" unpackWARs="true" autoDeploy="true">
			<Context path="" docBase="ROOT" debug="0" reloadable="true"/>
			<Valve className="org.apache.catalina.valves.AccessLogValve" directory="/home/madang01/gitsinnori/sinnori/project/sample_test/log/servlet"  prefix="tomcat_access_" suffix=".log" pattern="common" resolveHosts="false"/>
		</Host>


		8. tomcat 에서 AJP 활성화
		server.xml 를 보면 “Define an AJP 1.3 Connector on port 8009” 이부분이 있다. <Connector port="8009" protocol="AJP/1.3" redirectPort="8443" /> 부분의 주석을 풀어 준다.

		9. 아파치 신규 등록한 vhost 활성화
		sudo a2ensite vhost1\

		10. 아파치및 tomcat restart
		sudo /etc/init.d/tomcat7 restart
		sudo /etc/init.d/apache2 restart
	2. 윈도7
	생략

2. Tomcat 사전 지식
tomcat 정책상 setenv.sh 혹은 setenv.bat 은 CATALINA_BASE/bin 에 위
치한다. 
----------- 우분투 CATALINA_HOME/bin/catalina.sh 부분 인용
#   Do not set the variables in this script. Instead put them into a script
#   setenv.sh in CATALINA_BASE/bin to keep your customizations separate.

3. tomcat 에 신놀이 프레임워크 환경 변수 지정법
	1. 우분투
	우분투에서 CATALINA_BASE 는 /var/lib/tomcat7 이다. CATALINA_BASE/bin 디렉토리에서 root 권한으로 chmod a+x 로 setenv.sh 파일을 아래 내용으로 생성 한다.
------------ /var/lib/tomcat7/bin/setenv.sh
madang01@madang01-TZ68K:/var/lib/tomcat7/bin$ cat setenv.sh
#!/bin/sh
export SINNORI_CORELIB_PATH=/home/madang01/gitsinnori/sinnori/project/sample_test/client_build/web_build/corelib/ex

for jarfile in $SINNORI_CORELIB_PATH/*.jar
do
	export CLASSPATH=$CLASSPATH:${jarfile}
done

echo $CLASSPATH

export JAVA_OPTS="$JAVA_OPTS \
-Dlogback.configurationFile=/home/madang01/gitsinnori/sinnori/project/sample_test/config/logback.xml \
-Dsinnori.logPath=/home/madang01/gitsinnori/sinnori/project/sample_test/log/servlet \
-Dsinnori.configurationFile=/home/madang01/gitsinnori/sinnori/project/sample_test/config/sinnori.properties \
-Dsinnori.projectName=sample_test"



	2. 윈도7
	생략
</textarea>


